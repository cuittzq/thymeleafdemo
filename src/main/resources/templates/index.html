<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layouts/layout}">

<head>
    <title>Hello Spring Boot!</title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
    <link href="http://cdn.jsdelivr.net/webjars/bootstrap/3.3.6/css/bootstrap.min.css"
          th:href="@{/webjars/bootstrap/3.3.6/css/bootstrap.min.css}"
          rel="stylesheet" media="screen"/>
    <link href="../static/css/core.css"
          th:href="@{/css/core.css}"
          rel="stylesheet" media="screen"/>
    <script href="http://cdn.jsdelivr.net/webjars/jquery/2.2.1/jquery.min.js"
            th:src="@{/webjars/jquery/2.2.1/jquery.min.js}"></script>
    <script src="../static/js/angular.js"
            th:src="@{/webjars/angularjs/1.3.8/angular.js}"></script>
    <link href="http://cdnjs.cloudflare.com/ajax/libs/ng-dialog/0.3.7/css/ngDialog.min.css">
    <link href="http://cdnjs.cloudflare.com/ajax/libs/ng-dialog/0.3.7/css/ngDialog-theme-default.min.css">
    <link href="http://cdnjs.cloudflare.com/ajax/libs/ng-dialog/0.3.7/css/ngDialog-theme-plain.min.css">
    <script src="http://cdnjs.cloudflare.com/ajax/libs/ng-dialog/0.3.7/js/ngDialog.min.js"></script>


</head>
<body>
<th:block layout:fragment="content">
    <div ng-app="myApp" ng-controller="customersCtrl">
        <div><h1 th:text="${message}">原始数据，看见这个说明没有成功!</h1>
            <h1>部门管理</h1>
            <table class="table">
                <thead>
                <tr>
                    <th>ID</th>
                    <th>部门名称</th>
                    <th>部门描述</th>
                    <th>操作</th>
                </tr>
                </thead>
                <tbody th:each="deptinfo: ${deptInfos}">
                <tr>
                    <td>
                        <span th:text="*{deptinfo.id}">ID</span>
                    </td>
                    <td>
                        <span th:text="*{deptinfo.name}">Name</span>
                    </td>
                    <td>
                        <span th:text="*{deptinfo.describe}">describe</span>
                    </td>
                    <td>
                        <input class="btn btn-success" type="button"
                               th:attr="ng-click='editDeptInfo(\''+*{deptinfo.id}+'\');'" value="修改"/>
                        <input class="btn btn-danger" type="button"
                               th:attr="ng-click='deleteDeptInfo(\''+*{deptinfo.id}+'\');'" value="删除"/>
                    </td>
                </tr>
                </tbody>
            </table>
            <a href="" ng-click="openDefault()">Default theme</a>
        </div>
    </div>
    <script>
        var app = angular.module('myApp', ['ngDialog']);

        app.config(['ngDialogProvider', function (ngDialogProvider) {
            ngDialogProvider.setDefaults({
                className: 'ngdialog-theme-default',
                plain: false,
                showClose: true,
                closeByDocument: true,
                closeByEscape: true,
                appendTo: false,
                preCloseCallback: function () {
                    console.log('default pre-close callback');
                }
            });
        }]);
        app.controller('customersCtrl', function ($scope, ngDialog, $http) {
            /**
             *删除部门
             * @param deptID 部门ID
             */
            $scope.deleteDeptInfo = function (deptID) {
                //$scope.newssubcomment.mainComment.id = commentId;
                alert(deptID);
            };

            /**
             *打开弹窗
             */
            $scope.editDeptInfo = function (deptID) {
                ngDialog.open({
                    template: 'externalTemplate.html',
                    className: 'ngdialog-theme-plain',
                    scope: $scope
                });
            };

            $scope.openDefault = function () {
                ngDialog.open({
                    template: 'firstDialogId',
                    controller: 'InsideCtrl',
                    className: 'ngdialog-theme-default'
                });
            };

        });

        app.controller('InsideCtrl', function ($scope, ngDialog) {
            $scope.dialogModel = {
                message : 'message from passed scope'
            };
            $scope.openSecond = function () {
                ngDialog.open({
                    template: '<h3><a href="" ng-click="closeSecond()">Close all by click here!</a></h3>',
                    plain: true,
                    closeByEscape: false,
                    controller: 'SecondModalCtrl'
                });
            };
        });
    </script>

    <script type="text/ng-template" id="editdeptinfo.html">
        <div class="ui-dialog-title">
            标题
        </div>
        <div class="ui-dialog-content">

            <button type="submit" class="btn btn-primary"
                    ng-click="show()">
                保存
            </button>
            <button type="button" class="btn btn-primary"
                    ng-click="closeThisDialog()">
                取消
            </button>
        </div>
    </script>

    <script type="text/ng-template" id="externalTemplate.html">
        <p>External scope: <code>{{value}}</code></p>
    </script>

    <script type="text/ng-template" id="firstDialogId">
        <div class="ngdialog-message">
            <h3>ngDialog template</h3>
            <p ng-show="theme">Test content for <code>{{theme}}</code></p>
            <p ng-show="ngDialogId">Dialog Id: <code>{{ngDialogId}}</code></p>
            <p class="data-passed-through" ng-show="ngDialogData.foo">Data passed through: <code>{{ngDialogData.foo}}</code></p>
            <p ng-show="dialogModel.message">Scope passed through: <code>{{dialogModel.message}}</code></p>
            <p>Close this dialog: <button class="inline close-this-dialog" ng-click="closeThisDialog()">Close</button></p>

        </div>
        <div class="ngdialog-buttons">
            <button type="button" class="ngdialog-button ngdialog-button-secondary"
                    ng-dialog="secondDialogId"
                    ng-dialog-class="ngdialog-theme-default"
                    ng-dialog-controller="SecondModalCtrl"
                    ng-dialog-close-previous>Close and open</button>
            <button type="button" class="ngdialog-button ngdialog-button-primary" ng-click="openSecond()">Open next</button>
        </div>
    </script>
</th:block>
</body>
</html>